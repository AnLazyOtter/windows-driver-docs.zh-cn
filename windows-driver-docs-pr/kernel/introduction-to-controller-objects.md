---
title: 控制器对象简介
description: 控制器对象简介
ms.assetid: a46732a7-1e60-41d5-96e9-d5284c000af1
keywords:
- 控制器对象 WDK 内核，有关控制器对象
- ControllerControl 例程，有关 ControllerControl 例程
- 重叠的 I/O WDK 内核
- I/O WDK 内核重叠
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: b949b319fd2bd2e9c7307be4f733fbe1f8f87458
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/31/2019
ms.locfileid: "56576110"
---
# <a name="introduction-to-controller-objects"></a>控制器对象简介





顾名思义，控制器对象通常具有对象代表物理设备控制器连接的设备。 一组由物理控制器协调的类似设备的最低级别的非 WDM 驱动程序可创建控制器对象并使用它来同步 I/O 操作之间连接的设备。 该驱动程序实现[ *ControllerControl* ](https://msdn.microsoft.com/library/windows/hardware/ff542049)例程和调用 I/O 管理器的控制器对象支持例程。

**请注意**   WDM 驱动程序不支持的控制器对象的使用。

 

通常情况下，驱动程序使用控制器对象同步到连接的设备的操作，如果以下条件保存：

-   控制器不会执行长时间操作而不会中断，因此驱动程序不需要创建设备专用线程或使用系统工作线程数。

-   连接到控制器的设备是类似的。 也就是说，它们不是具有完全不同的物理属性或操作的功能，例如，可以连接到键盘和辅助设备控制器的键盘和鼠标设备的设备。

-   该驱动程序旨在作为整体化： 单图层与设备控制器和连接的物理设备，而不是正在设计作为端口驱动程序 （适用于控制器） （适用于连接的设备） 的一个或多个类驱动程序上层端口驱动程序。

具有的 I/O 通道的设备驱动程序和一组逻辑设备对象还可能使用控制器对象来同步它们之间或在此类设备的通道之间的 I/O 操作。

控制器对象没有名称，因此不是输入/输出请求的目标。 它是只需同步机制的一组设备对象从其序列化 I/O。 因为控制器对象没有名称，是看不到用户模式下受保护的子系统，而不会获得一个句柄表示的目标设备对象的文件对象不能进行设备 I/O 请求。 控制器对象也是看不到更高级别的驱动程序，它不能将其自己的设备对象附加到控制器对象。 换而言之，I/O 管理器和更高级别的驱动程序都不可以将设置 IRP I/O 请求的控制器对象所表示的设备上。 I/O 请求始终颁发给设备对象。 只有驱动程序可以使用控制器对象。

### <a name="synchronization-and-overlapped-io"></a>同步和 I/O 重叠

整体化的功能，如"AT"磁盘控制器的物理设备的驱动程序不需要使用控制器对象来同步其设备的 I/O 操作。 例如，驱动程序编写器可以尝试类似于以下的同步技术，而不是使用控制器对象的内容：

-   设置命名的设备对象以表示针对输入/输出请求的设备。

-   维护状态信息 （可能是一组设备繁忙标志或单个设备扩展中每个设备扩展），该值指示哪个设备对象当前的 I/O 操作的目标。

-   执行当前正忙的设备对象的 I/O 操作并将传入 Irp 的其他设备对象重新排队，直到完成当前的 IRP。

上述的同步方法序列化的所有驱动程序的目标设备对象处理 IRP。 请注意它也会强制驱动程序来完成当前 IRP 之前其[ *StartIo* ](https://msdn.microsoft.com/library/windows/hardware/ff563858)例程可以开始处理下一步 IRP，遗憾的是减少驱动程序性能。

如果可以重叠某些设备操作，使用控制器对象可以提高驱动程序的 I/O 吞吐量，因为此同步方法使驱动程序以确定是否设置物理设备之前，它可以重叠操作。 例如，磁盘控制器可能会使驱动程序添加到重叠查找一个磁盘上与另一个磁盘上的读/写操作。

此外，使用控制器对象是相对较简单办法通过单个物理设备，例如"AT"磁盘控制器同步多个目标设备对象的 I/O 操作。 使用控制器对象允许在一组指定的设备对象间同步 I/O 操作，而不必维护有关每个设备和一个或多个设备扩展中的，在设备控制器的状态，且不会重新排队 Irp 的整体化驱动程序。

但是，专为重叠 I/O 操作，如全双工串行控制器或主机总线适配器的支持，某些设备通常具有为 Irp 设置内部队列的驱动程序。

 

 




