---
title: 热替换的分区单位
description: 热替换的分区单位
ms.assetid: 6d50dc7d-6c3b-41e5-b6eb-aead9833dd1e
keywords:
- 动态硬件分区 WDK，热替换
- 硬件分区 WDK 动态、 热替换
- 分区 WDK 动态硬件，热替换
- 热替换 WDK 动态硬件分区
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: 0cac476042cecc13b09c77426a96825edcac7975
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/31/2019
ms.locfileid: "56533662"
---
# <a name="hot-replace-of-partition-units"></a>热替换的分区单位


在动态可分区服务器上，您可以动态替换硬件分区中的分区单元在任何时间。 这被称为热替换操作。 当替换分区单元时，操作系统会将硬件分区放入伪 S4 休眠状态。 若要将该硬件分区放入此特殊睡眠状态，操作系统将 S4*将幂设置*到系统中的所有设备驱动程序的电源管理请求。 但是，与典型的 S4 电源状态，不同的操作系统不会写入到休眠文件系统的状态。

设备驱动程序必须支持通过正确处理此伪 S4 休眠状态*查询 power*并*将幂设置*电源管理请求。 设备驱动程序应永远不会拒绝*查询 power*请求。 当设备驱动程序收到 S4*将幂设置*电源管理请求，它必须转换到 D3 设备电源状态其设备，并停止所有 I/O 操作。 这包括任何当前正在进行的直接内存访问 (DMA) 传输。 驱动程序的设备置于低功耗状态、 禁用中断和停止正在进行中的所有 I/O 操作，通过替换操作可以继续而不会影响设备驱动程序。

D3 电源状态的设备驱动程序的设备时，设备驱动程序应队列收到任何新的 I/O 请求。 设备驱动程序应使用 I/O 超时期限，在 I/O 请求它的处理。 此超时期间必须足够长的时间，以便输入/输出请求将不会超时，如果停止或在分区单元的更换过程中排队。 当操作系统继续从伪 S4 休眠状态时，设备驱动程序可以继续处理任何已停止或已排队的 I/O 请求。

有关如何在设备驱动程序中实现支持电源管理的详细信息，请参阅[电源管理](implementing-power-management.md)。

设备驱动程序未绑定到如特定处理器的系统硬件的唯一地标识实例本身。 否则，如果包含该硬件分区单元替换硬件分区中，可能会失败，驱动程序。

 

 




