---
title: HID 客户端驱动程序
description: 如果系统提供 HID 微型驱动程序不支持设备的端口或总线，则需要供应商提供微型驱动程序。
ms.assetid: E7C57273-B661-4B82-816E-E1466DAF67EA
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 76170465bc521d8ed3da1b44467847d01b0586fa
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "63388869"
---
# <a name="hid-client-drivers"></a>HID 客户端驱动程序


如果系统提供 HID 微型驱动程序不支持设备的端口或总线，则需要供应商提供微型驱动程序。




下图说明了泛型的 HIDClass 设备 （这可能会使用可选和必需供应商提供的组件） 的驱动程序堆栈。

![说明泛型 hidclass 设备驱动程序堆栈的关系图](images/zzhgdrs.png)

Windows 生成的驱动程序堆栈，如下所示：

-   传输堆栈的每个附加的 HID 设备创建一个物理设备对象 (PDO) 并加载相应的 HID 传输驱动程序又将 HID 类驱动程序。
-   HID 类驱动程序创建 TLC PDO。 对于带有多个 TLC 的复杂设备，HID 类驱动程序为每个 TLC 创建 PDO，并确保 TLC 与关联的硬件 ID 中包含一个标识符，以表示每个设备对象。
-   供应商提供的函数或筛选器驱动程序创建 FDO 或 HID 集合的筛选器执行操作。
-   供应商提供的应用程序或者可以打开设备使用 SetupDI\* Api 来标识设备，然后 HID 支持例程以与设备通信。 此类设备被称为 RAW 模式中打开。

如果系统提供[微型驱动程序操作](minidriver-operations.md)不支持某种设备、 供应商提供 HID 微型驱动程序是必需的。 可以通过两种方式来实现此微型驱动程序：

-   HID 客户端驱动程序
-   应用程序直接访问 HID

如果供应商提供的驱动程序 （而不是微型驱动程序），该驱动程序：

-   必须符合 Windows 驱动程序的最低要求。 理想情况下，这应基于用户模式驱动程序框架 (UMDF) 或内核模式驱动程序框架 (KMDF)。 不太理想的解决方案是创建 WDM 函数驱动程序，如 Windows 驱动程序模型中所述。
-   通常支持供应商定义的设备接口--请参阅设备接口的类。 较高级别驱动程序或用户模式应用程序使用自定义接口访问的设备的供应商驱动程序将运行。 自定义接口都可能添加功能，或可能是，简化的 HID 类驱动程序的接口。

如果该驱动程序不是功能驱动程序或筛选器驱动程序，它可以使用插通知查找 HID 集合。 后查找集合，该驱动程序打开集合，并在函数或筛选器驱动程序与相同的方式运行它。

重要说明：

-   如果供应商提供的函数驱动程序创建 FDO 或筛选器是否为 HID 集合，它不应使用文件的 FsContext 字段\_对象来存储文件特定于对象的数据。 FsContext 字段被保留的 HID 类驱动程序。 如果堆栈中的另一个驱动程序所需存储文件特定于对象的上下文数据，它应改为使用 FsContext2 字段。
-   如果有多个设备连接到 PDO，没有内置的机制来确定哪些设备可以使用 FsContext2 字段。

 

 




