---
title: 调试-使用跟踪文件按时间顺序查看
description: 本部分介绍如何处理时间旅行跟踪文件
ms.date: 04/15/2019
ms.localizationpriority: medium
ms.openlocfilehash: 4af89ffd5225da70fb1ad1da0a9b60771c25b7af
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "63379188"
---
![显示时钟的较短时间的行程徽标](images/ttd-time-travel-debugging-logo.png) 

# <a name="time-travel-debugging---working-with-trace-files"></a>调试-使用跟踪文件按时间顺序查看

本部分介绍如何使用创建和使用的时间旅行调试文件。

## <a name="trace-file-overview"></a>跟踪文件概述

时间旅行调试使用以下文件来调试代码执行。

- 包含代码执行记录，但不在跟踪文件。运行扩展。

- 索引文件可以快速访问信息的跟踪文件中并且具有。IDX 扩展。

- 记录错误和其他记录输出写入调试器日志文件。


## <a name="trace-run-files"></a>将跟踪中。运行文件  

将跟踪中。在记录使用后，可以打开运行的文件**文件** > **开始调试** > **打开跟踪文件**。

![文件打开选项显示突出显示打开的跟踪选项](images/ttd-start-debugging-options.png) 

所有跟踪输出文件默认存储在用户文档文件夹中。 例如，为 User1 TTD 文件将存储在此处：

```console
C:\Users\User1\Documents
```
当你开始记录，可以更改跟踪文件的位置。 有关详细信息，请参阅[调试-记录按时间顺序查看](time-travel-debugging-record.md)。

最近使用过的文件列表，可以快速访问以前使用过目标配置文件。 最近使用的任何跟踪文件或转储文件也将列出。 

![文件打开列出的.run 跟踪文件显示 5 个最近使用的跟踪文件](images/ttd-recent-trace-files.png) 


## <a name="index-idx-files"></a>索引。IDX 文件  

一种索引。有关关联跟踪创建 IDX 文件。在 WinDbg 预览中打开跟踪文件时自动运行文件。 您可以通过使用手动创建的索引文件 ！ 索引命令。 索引可以更快地访问跟踪信息。 

IDX 文件也可能很大，通常两次的大小。运行文件。  

## <a name="recreating-the-idx-file"></a>重新创建。IDX 文件
你可以重新创建。从 IDX 文件。运行文件，请使用`!index`命令。 有关详细信息，请参阅[调试旅行时间-！ 索引 （时程）](time-travel-debugging-extension-index.md)。

```dbgcmd
0:0:001> !index
Indexed 3/3 keyframes
Successfully created the index in 49ms.
```

## <a name="sharing-ttd-trace-run-files"></a>共享 TTD 跟踪。运行文件

TTD 只是本地的和不起作用到另一台计算机远程连接。

可以通过复制与他人共享 TTD 跟踪文件。运行文件。 这可以非常方便地让同事帮助找出问题。 它们无需安装故障的应用程序或执行任何其他相关安装程序以尝试重现此问题。 它们只是可以加载跟踪文件，并像它已安装在其电脑上调试应用程序。

其中重播 TTD 跟踪此计算机必须支持在记录计算机-例如 AVX 说明使用的所有指令。

您可以重命名文件以包括任何其他信息，例如日期或 bug 数量。

。IDX 文件不需要复制，因为它可以重新创建使用 ！ 索引命令，如上文所述。

> [!TIP]
> 当与其他人协作，将传递在与手头的问题相关的任何相关的跟踪位置上。 协作者可以使用`!tt x:y`命令中的代码的执行时间，将移动到的确切点。 时间位置范围可以包含在 bug 说明来跟踪可能会发生可能存在问题的位置。
>


## <a name="error---log-file"></a>错误-日志文件

记录错误和其他记录输出写入调试器日志文件。 若要查看日志文件，请选择**视图** > **日志**。 

此示例显示错误日志文本时尝试启动并记录名为 Foo.exe C:\Windows 目录中不是一个可执行文件。

```console
2017-09-21:17:18:10:320 : Information : DbgXUI.dll : TTD: Output: 
Microsoft (R) TTD 1.01.02
Release: 10.0.16366.1000
Copyright (C) Microsoft Corporation. All rights reserved.
Launching C:\Windows\Foo.exe
2017-09-21:17:18:10:320 : Error : DbgXUI.dll : TTD: Errors: 
Error: Trace of C:\Windows\Foo.exe PID:0 did not complete successfully: status:27
Error: Could not open 'Foo.exe'; file not found.
Error: Corrupted trace dumped to C:\Users\User1\Documents\Foo01.run.err.
```



## <a name="trace-file-size"></a>跟踪文件大小

TTD 跟踪文件可以获得非常大，必须确保有足够的可用磁盘空间。  如果甚至只是为几分钟时间录制的应用程序或进程，跟踪文件可以增长以达到数千兆字节的大小。  跟踪文件的大小是依赖于许多因素，如下所述。  

TTD 不会设置跟踪文件以复杂的长时间运行的情况下允许的最大大小。 快速重新创建此问题，将保留跟踪文件大小越小越好。
 
### <a name="trace-file-size-factors"></a>跟踪文件大小因素

不能提供和精确的估计值但有的跟踪文件大小是几个规则的经验法则可帮助您了解 TTD 文件大小。

以下因素会影响跟踪文件的大小：

- 记录正在运行的应用程序或进程时，跨所有线程执行的代码指令数
- 在此期间的应用程序或进程记录的时间 （仅因为它会影响的记录的代码指令数） 的长度
- 使用应用程序或进程的内存数据的大小
 
执行和记录对指令数是影响跟踪文件大小的最大因素。  跟踪通常需要 1 的位和每个指令执行 1 个字节之间。  跟踪很可能是该范围的较低的末尾时记录的程序执行较小数目的不同的功能，并对较小的数据集。  跟踪很可能记录的程序执行更多的不同的功能或对一组更大的数据进行操作时，为该范围的更高版本的末尾。
 
### <a name="trace-file-size-rule-of-thumb"></a>跟踪文件大小的经验法则

跟踪文件将增长到 50 MB 每秒时记录的活动的应用程序或进程，具体取决于跟踪文件大小为上述因素大约 5 MB。

当应用程序或进程正在记录处于空闲状态 （例如，当等待输入） 时，不会增长的跟踪文件。

目前跟踪文件没有最大文件大小限制。  WinDbg 预览版可以重播跟踪文件中的千兆字节为单位的大小数百个。
 
### <a name="index-file-size"></a>索引文件大小

第一次打开的跟踪时，WinDbg 预览自动创建的索引文件。  它包含可帮助调试程序重播跟踪，并更有效地查询内存有关的信息的信息。  其大小通常介于 1 到 2 倍的跟踪文件的大小。  会影响其大小的因素是类似于影响跟踪文件的大小。
 
首先，索引文件的大小缩放相对于跟踪的长度。  包含更多的录制的指令的跟踪通常具有较大索引。
 
其次，索引的大小缩放相对于内存访问的范围。  如果程序频繁地记录访问大量的非重复的内存位置，索引通常是大于记录程序访问的更少的非重复的内存位置或者如果内存位置的访问频率较低。
 
由于这些因素都是类似于跟踪文件的大小会影响的因素，索引文件的大小通常缩放相对于索引文件 （因此我们估计值，它通常为 1 x 和 x 的跟踪文件大小的 2 之间） 的大小。
 
### <a name="what-if-i-run-out-of-disk-space"></a>如果我运行磁盘空间不足？

TTD 跟踪和索引文件写入到磁盘。 目前还没有跟踪或索引的文件的最大文件大小限制。 跟踪文件的大小增大，直到停止录制或超过可用磁盘空间量。
 
*在录制：* TTD 将写出到跟踪文件的最后一页，然后有效地等待，直到它可以重新编写。 WinDbg 仍显示记录对话框中，但不显示错误/警告消息，这是在录制过程中磁盘空间不足运行时。  

磁盘空间不足期间录制结果跟踪文件中使用的代码执行的不完整记录。 未完成的跟踪文件可以在 WinDbg 预览中打开，但如果错误发生后的磁盘空间不足，写入跟踪文件时可能不包含实际问题。

解决方法：打开文件资源管理器并检查磁盘 （即 c： 驱动器） 的可用空间是否接近于零。 或者观看跟踪 (。运行） 在文件资源管理器 （在文档文件夹中的默认值） 文件，并可能等待如果大小则不定期增长。 单击停止和调试按钮在 WinDbg 中的，释放空间或将保存到另一个磁盘，然后再次开始录制。
 
*在编制索引：* 调试器可能生成无效的索引文件，从而导致不可预知的行为，在调试器中，或调试器引擎主机可能会崩溃。

解决方法：关闭调试器并删除任何索引文件 (.idx) 可能存在的跟踪。  释放足够的磁盘空间，或者将跟踪文件移动到另一个磁盘具有足够的可用空间。  在调试器中再次打开跟踪并运行 ！ 若要创建一个新的正确索引的索引。  索引不会修改原始跟踪文件 （运行），以便将任何数据不已丢失。

## <a name="see-also"></a>请参阅

[按照时间顺序逐个调试-概述](time-travel-debugging-overview.md)

---
