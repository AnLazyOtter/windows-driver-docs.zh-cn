---
title: 计时翻转
description: 计时翻转
ms.assetid: abd3188e-0f75-401a-88e3-e2a9c5788ad5
keywords:
- 绘制翻转页面 WDK DirectDraw、 计时
- DirectDraw 显示翻转 WDK Windows 2000，计时
- 页面翻转 WDK DirectDraw 计时
- 翻转 WDK DirectDraw、 计时
- 计时翻转 WDK DirectDraw
- WDK DirectDraw 持续显示时间
- 消除 WDK DirectDraw
- 扫描行 WDK DirectDraw
- 显示 WDK DirectDraw 翻转
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: c7b99ce62e87932f52a700c4dd903e3cd5d95194
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/31/2019
ms.locfileid: "56547506"
---
# <a name="timing-a-flip"></a>计时翻转


## <span id="ddk_timing_a_flip_gg"></span><span id="DDK_TIMING_A_FLIP_GG"></span>


计时翻转是非常简单，如果翻转注册可用且已知扫描行。 然后，只需选中翻转注册以查看是否已发生最后翻转，请确保扫描行垂直留空不是进行翻转之前。 如果扫描行和翻转寄存器不可用，但是，使用一个或多个以下的段中所述的算法。

-   如果用于检查扫描行是否已完成刷新周期不有点具有硬件，应使用多个方法来翻转的时间。 替代方法基于已用时间。 它是可以翻转如果绘制的整个图面有足够的时间已过自最后一个翻转。 此时间量确定凭经验 （除非已知的监视器的刷新频率） 在驱动程序初始化时和模式的更改进行轮询之前显示在垂直同步中，然后轮询之前它不是垂直同步。这是通过为 20 次迭代，线程执行优先级设置为最大值。 结果除以 20 以便*显示持续时间*。 这是允许对后台缓冲区的访问权限之前等待的最大时间。 （如果显示持续时间已知，它不会不需要进行计算。）在大多数情况下，要短得多的时间，需要先进行翻转，但因为它是完全可靠，使用显示持续时间作为回退。

-   如果只有扫描行的行号，则最快方法是记录的时间和扫描行。 然后，当扫描行小于比之前，已通过刷新周期。 例如，如果扫描行是在行 300 第一次其进行轮询，并在第 50 行下一次，然后整个图面显示至少一次。 但是，扫描行不完全可靠所有显示卡上。 在某些情况下可以从读取和写入到在同一时间为两个不同的数字的下半部分提供寄存器。 在这些情况下，必须读取注册两次以验证它报告正确数目。 在某些情况下扫描行可能不准确，通过水平同步。用于指示扫描行当前是否显示在通常的标志返回 false 的负数结果，而扫描线是水平留空。

-   如果扫描行的行号不可用，它可能能够验证扫描行已通过从显示通过垂直空白状态并重新显示。 按跟踪在扫描行通过传入和传出显示，您可以确定整个刷新周期已结束时。 若要检查扫描行是否在显示或垂直空白中的功能应可对所有显示卡，但扫描行数可能不会。

可能需要一些调整以获取超出显示闪烁的最后一个位，例如，确保地址 （例如，转移右两个位置，以获取的真实地址，因为该地址是双字节边界上） 读取后发生任何计算。 若要避免撕裂现象，请确保，扫描行垂直留空，是正上方垂直同步，并不是在显示之前写入翻转注册。

尽管基于显示卡上原始 IBM 视频图形卡 (VGA) 规范，超级 VGAs 差异相当大 (请参阅*EGA、 VGA，和超级 VGA 卡程序员指南*Richard F.Ferraro-Addison Wesley，最新的版本）。 某些卡提供没有简便的方法确定是否将扫描线是垂直留空，或者它是否即使在显示。 这些缺陷变得与竞争对手以满足高级的显示功能增加的需求更重要。 在此期间，驱动程序编写人员必须使用创造力来弥补这些不足之处。

后可以翻转，接下来是在翻转寄存器中被加载到图面以显示引用。 会扫描行获取过去的垂直同步，并返回到显示区域是之前执行任何操作。 然后翻转注册一次读取。 如果其他内容存储在翻转，注册的时间之前，或如果它正在读取，拆解发生一次写入图面。 一旦读取该寄存器时，应不锁定或仍绘制时写入到图面。

检查是否已读取该寄存器是只需检查中大多数较新的卡的标志。 在较旧卡，但是的硬件中断了通常用于此目的。 已超过特定的时间点时注册中翻转读时，任何函数挂接到，将名为中断。 问题在于此中断可能会用于其他目的在某些较新的硬件。

 

 





