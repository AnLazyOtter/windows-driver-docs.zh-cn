---
title: 通信模型、 同步和中止
description: 本部分介绍 WDI 通信模型、 同步和中止
ms.assetid: 575D1314-8726-49C1-AE6C-C171FE1CD2AD
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 61c1afebe5f124a97184814f870374981c7fde41
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "63324420"
---
# <a name="communication-model-synchronization-and-abort"></a>通信模型、 同步和中止


在高级别，本文档定义了两种类型的对象：

1.  适配器，表示 Wi-fi 设备。
2.  一个端口，表示在适配器中不同的 MAC 和物理实体。

有关这些对象的详细信息，请参阅[Wi-fi 设备模型和对象](wdi-objects.md)。
命令，许可操作，一组定义的每个这些对象。 命令进一步分为属性和任务。

属性命令都是简单的命令 （如获取信号强度，获取当前的 BSS 列表和数据包筛选器设置）。 这些在时间在短时间内完成，不复杂而无法实现。

任务的命令是可能需要几秒钟才能完成的复杂操作。 例如，Wi-fi 扫描操作将属于此模型中的任务。

可以以异步方式完成到 IHV 组件发出的所有命令。

## <a name="sequence-of-messages"></a>消息的顺序


每种类型的命令消息的顺序是以下各图所示。

图 1 显示了任务命令序列。

![wdi 命令任务流](images/wdi-command-task-flow.png)

图 2 显示了属性命令流。

![wdi 属性命令流](images/wdi-property-command-flow.png)

图 3 显示了指示的流。

![wdi 指示流](images/wdi-indication-flow.png)

## <a name="synchronization"></a>同步


为了简化 IHV 组件实现，模型定义了以下同步规则：

1.  命令始终进行步骤 1 和图 1 和图 2 中的 3 之间序列化。 例如，没有新命令颁发给该适配器之前指示从在步骤 3 适配器。 这还意味着，与每个其他情况下的所有属性进行序列都化。
2.  步骤 1 和图 1 中的 4 之间序列化任务的所有命令。 例如，只有一项任务将在适配器上运行一次。 但是，一旦启动一项任务 (图 1 中的步骤 3)，该适配器可能会收到属性命令请求。 在发送下一个任务命令之前，必须完成步骤 3 和步骤 4。
3.  属性 set 命令有两种类型 – 后启动该任务后，可以发送和必须与挂起的任务序列。
4.  使用命令的路径、 更高版本的文档中介绍的特定情况下除外不序列化数据路径。
5.  同步作用域是适配器级别作用域。
6.  已启动后，可以中止任务的子集。 这意味着，如果任务的优先级越高 （A） 收到未完成较低优先级任务 (B) 时，可以将 B 中止的主机。 确定优先级的决策合理化超出了本文档讨论范围，以及什么依赖于用户方案。
7.  对于任务的命令，完成步骤 3 之前可以来自步骤 4。 但是，如果指示第 4 步，不能失败步骤 3。

## <a name="abort"></a>中止


已启动后，可以中止大多数任务。 中止旨在触发适配器发送完成的指示 (图 1 中的步骤 4) 来快速完成任务。 中止允许仅在该时间间隔的步骤 3 和 4 中图 1 中。 在接收时中止，适配器必须完成 50 毫秒内的任务。 大多数命令，在收到中止时不需要启动此命令之前回滚到状态适配器。 中止命令发出和完成到达主机组件之间存在争用条件。 在这种情况下，如果 IHV 组件收到其已完成的任务以中止时，任何进一步的操作则不需要从 IHV 组件来处理中止操作。 中止任务是只需 IHV 组件应尽快清理任务的信号。 如果发出了 abort，则不会更改命令完成语义。 完成的任务完成指示中止属性命令，以及必须相应地在所有情况下收到通知。

属性应完成在短的时间，因此不能已中止。

任务命令具有使面向特定命令的中止的主机的唯一标识符。

 

 





