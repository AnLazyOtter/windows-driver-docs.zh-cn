---
title: Wi-Fi 热点卸载体系结构
description: Wi-Fi 热点卸载体系结构
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 28e848f5f4c92eb741c7dc023964d5952a2d9600
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "63365759"
---
# <a name="wi-fi-hotspot-offloading-architecture"></a>Wi-Fi 热点卸载体系结构

[!include[Wi-Fi Hotspot Offloading deprecation](wi-fi-hotspot-offloading-deprecation.md)]

下图显示的 Wi-fi 卸载 Framework 中的主要组件。

![Wi-fi 热点卸载 Framework](images/WiFi_Hotspot_Offload-1.png "的 Wi-fi 热点卸载 Framework")

## <a name="hotspot-offload-service"></a>热点卸载服务

热点卸载服务执行以下功能：

* 标识是热点网络的 Wi-fi 网络
* 可创建和维护到热点网络的连接监视
* 监视和响应的热点网络连接状态更改
* 监视和响应来启用或禁用的 Wi-fi 热点卸载用户设置中的更改

热点卸载服务依赖于热点插件创建的标识和验证其热点网络移动运营商和/或 Oem。

## <a name="hotspot-plugin-host"></a>热点插件主机

热点插件宿主是作用点之间的接口卸载服务和合作伙伴实现热点插件。 例如，对热点插件，以识别热点网络与网络的列表的查询都通过热点插件主机。 插件宿主也允许热点插件以，除此之外，发送和接收 HTTP 消息通过 WinHTTP/WinInet API，向用户发送短信警报和通知。

热点卸载服务负责创建热点的每个插件的热点插件主机。

## <a name="hotspot-plugin"></a>热点插件

热点插件执行以下功能：

* 标识从可用的网络列表的热点网络
* 启用自动连接到 SIM/EAP-AKA 和基于 HTTP 的身份验证，使用指定的 OEM 或移动运营商网络
* 通过 WinHTTP/WinInet API 发送和接收 HTTP 消息
* 向用户发送短信通知
* 选择 HTTP 请求来发送和接收消息，通过移动电话网络的持有者令牌

它还直接与以下外部组件进行交互：

* WinInet/WinHTTP

移动运营商和/或 Oem 必须实现和安装其自己的热点插件来启用 Wi-fi 卸载。 该插件的安装包包括以下组件：

* 插件 DLL
* 文件包含特定于连接的信息，例如的 Ssid，加密的凭据，等等。
  * **注意：** 这些文件是可选的不应出现在大多数的插件。
* 注册表配置

## <a name="hotspot-user-interface"></a>热点用户界面

热点用户界面显示在控制面板中的 Wi-fi。 通过用户界面，用户可以：

* 启用/禁用自动的 Wi-fi 热点卸载。
* 在自动连接到热点网络过程中查看连接状态。
* 手动连接到热点网络。
  * 如果要卸载热点在设备上启用功能，用户启动连接到网络热点卸载服务已标识为将作为自动连接到 Wi-fi 热点网络处理热点网络。 否则，将作为标准的 Wi-fi 连接处理手动连接。
* 如果用户已禁用的移动运营商热点连接，配置到热点网络连接正常的 Wi-fi 配置文件。

至少一个插件配置时，仅显示热点用户界面。

## <a name="example-automatic-connection-to-a-hotspot-network"></a>例如：自动连接到热点网络

下面是非常高级的组件自动连接到热点网络期间发生的交互序列的描述：

1. Wi-fi 连接服务将未连接的网络的列表发送到热点卸载服务。
2. 对于在网络列表中每个条目，热点卸载服务查询 （按插件进行了排序顺序） 的热点插件来确定它是否热点网络。 第一个插件来识别网络，需要在连接时对该网络进行身份验证。
3. 当热点插件标识为热点网络的网络时，它返回与该网络 （无论它是基于 HTTP 的还是 EAP-SIM 基于，或需要任何特定 SIM） 要使用的身份验证方法相关联的优先级值和 （可选） 网络显示掩码。 优先级值指示应尝试连接的顺序。 到较高的值与网络的连接之前，将尝试连接到具有较低的优先级值的网络。
4. 热点卸载服务创建所选网络的连接管理器配置文件。
5. 热点卸载服务配置文件还可以配置将导致连接管理器阻止应用程序连接到网络之前获得授权的初始策略设置。
6. 热点卸载服务将所选的网络标记为热点网络。
7. 热点卸载服务调用热点插件，通过热点插件宿主，以执行任何预先处理需要时进行连接。
8. 热点插件已完成后连接处理前，热点卸载服务在等待为连接管理器连接到热点网络，并提供连接完成或失败的通知。
9. 连接完成后，热点卸载服务发送请求到热点插件以执行任何必要后连接操作，例如 HTTPS exchange。
10. 在此期间，热点卸载服务执行以下任务：
    * 将启动一个计时器以完成连接后的活动 （当前设置为 5 分钟后触发）
    * 设置适当的用户界面显示状态
11. 如果热点插件指示连接成功，热点卸载服务调用要取消阻止连接，并通知应用程序的连接管理器。
12. 如果后的连接请求超时：
    * 热点卸载服务重置热点插件的状态。
    * 如果不是重试已用尽热点卸载服务启动尝试重新连接，否则它会删除网络的热点配置文件。
13. 如果热点插件指示失败和重试次数是有可能，热点卸载服务启动尝试重新连接，否则将其删除网络的热点配置文件。

